<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <script type="text/javascript" src="//cdn.txooo.com/public/html5/rem.js"></script>
    <link type="text/css" rel="stylesheet" href="/Skin/t/Css/Public.css" />
    <link type="text/css" rel="stylesheet" href="/Skin/t/Css/MyTeam.css" />
    <script type="text/javascript" src="//cdn.txooo.com/public/jquery/jquery-1.7.2.min.js"></script>
    <script type="text/javascript" src="//cdn.txooo.com/public/aui.artTemplate/artTemplate.js"></script>
    <script src="/Skin/t/Js/Template.js"></script>
    <script src="/Skin/t/Js/Public.js"></script>
    <title>我的团队</title>
</head>
<body>

    <div class="bind_method_login" style="display:none;">
        <div class="bind_show">
            <iframe src="" style="width:100%;height:100%;"></iframe>
        </div>
    </div>
    <section>
        <div class="T_head_box">
            <div class="T_head">
                <div class="head_pic"><a href="/Money/Index.html"><img onerror="this.src='/Skin/t/Img/no_pic.png'" src="/Skin/t/Img/no_pic.png" /></a></div>
                <div class="pic_r">
                    <p><b class="tit">我的团队</b>&nbsp;&nbsp;<span class="rec_user"></span></p>
                    <p>共<b class="user_count">0</b>人，近一月新增<b class="users_month"> 0 </b>人，<a href="#" id="link1"><span class="c_yellow">排名<b class="users_month_rank"> 0 </b>位</span></a></p>
                </div>
                <!--<div class="friend_icon friend_icon_1">
                    <a href="/Quan/index.html"><em><i>&#xe63f;</i></em></a>
                </div>
                <div class="friend_icon friend_icon_2">
                    <a href="/Chat/Quan/ChatList.html"><em><i>&#xe63e;</i></em></a>
                </div>-->
            </div>
            <ul class="T_nav">
                <li>
                    <span>团队已赚</span>
                    <span>0.00元</span>
                    <em>排名0位</em>
                </li>
                <li>
                    <span>团队佣金</span>
                    <span>0.00元</span>
                    <em>排名0位</em>
                </li>
                <li>
                    <span>团队创业金</span>
                    <span>0.00元</span>
                    <em>排名0位</em>
                </li>
                <li>
                    <span>团队V币</span>
                    <span>0.00元</span>
                    <em>排名0位</em>
                </li>
            </ul>
            <ul class="navXQT dis_box">
                <li class="box_flex_1"><a href="/Chat/Quan/NewsList.html"><span class="pic"></span><em>消息</em></a></li>
                <li class="box_flex_1"><a href="/Chat/Quan/ChatList.html"><span class="pic"></span><em>群组</em></a></li>
                <li class="box_flex_1"><a href="/Quan/index.html"><span class="pic"></span><em>团队圈</em></a></li>
            </ul>
        </div>
        <div class="T_con">
            <div class="T_con_list_box">
                <div class="T_con_list">
                    <div class="T_con_description">我的邀请人</div>
                    <dl></dl>
                    <div class="T_con_description">团队成员</div>
                    <dl>
                        <!--<dt>A</dt>
        <dd class="dis_box">
            <div class="pic box_flex_1"><img src="" /></div>
            <div class="name box_flex_2">啊三毛</div>
            <div class="level box_flex_3">第三级</div>
        </dd>
        <dd class="dis_box">
            <div class="pic box_flex_1"><img src="" /></div>
            <div class="name box_flex_2">啊三毛</div>
            <div class="level box_flex_3">第三级</div>
        </dd>-->
                    </dl>
                </div>
            </div>
            <div>
                <a href="javascript:void(0);" onclick="LoadMore()" id="more" class='more'>加载中...</a>
            </div>
            <!--<div class="Index">
                <ul>
                    <li>A</li>
                    <li>B</li>
                    <li>C</li>
                    <li>D</li>
                    <li>E</li>
                    <li>F</li>
                    <li>G</li>
                    <li>H</li>
                    <li>I</li>
                    <li>J</li>
                    <li>K</li>
                    <li>L</li>
                    <li>M</li>
                    <li>N</li>
                    <li>O</li>
                    <li>P</li>
                    <li>Q</li>
                    <li>R</li>
                    <li>S</li>
                    <li>T</li>
                    <li>U</li>
                    <li>V</li>
                    <li>W</li>
                    <li>X</li>
                    <li>Y</li>
                    <li>Z</li>
                </ul>
            </div>-->
        </div>
    </section>

    <!-- 头部信息begin -->
    <!--WL_TMP{tmp=/Skin/t/Pub/T_Foot.html}-->
    <!-- 头部信息end -->
    <script type="text/html" id="childTemp">
        {{each info as i}}
        <dd onclick="window.location.href = '/homepage/index.html?uid={{i.user_id}}';">
            <div class="pic left"><img src="{{i.head_pic | headPic}}" /></div>
            <div class="name_level left">
                <div class="name">{{i.nick_name}}</div>
            </div>
        </dd>
        {{/each}}
    </script>
    <script type="text/html" id="moneyTemp">
        <li>
            <span>团队已赚</span>
            <span>{{info.team_assets | toFloat}}元</span>
            <em>排名{{info.team_assets_rank}}位</em>
        </li>
        <li>
            <span>团队佣金</span>
            <span>{{info.team_brokerage  | toFloat}}元</span>
            <em>排名{{info.team_brokerage_rank}}位</em>
        </li>
        <li>
            <span>团队创业金</span>
            <span>{{info.team_bonus | toFloat}}元</span>
            <em>排名{{info.team_bonus_rank}}位</em>
        </li>
        <li>
            <span>团队V币</span>
            <span>{{info.team_point | toFloat}}个</span>
            <em>排名{{info.team_point_rank}}位</em>
        </li>
    </script>
    <script type="text/html" id="levelCountTemp">
        <li class="box_flex_1" data-level="0">
            <div>
                <span>全部</span>
                <em>{{info.all_users}}人</em>
            </div>
        </li>
        <li class="box_flex_1" data-level="1">
            <div>
                <span>第一级</span>
                <em>{{info.level1_users}}人</em>
            </div>
        </li>
        <li class="box_flex_1" data-level="2">
            <div>
                <span>第二级</span>
                <em>{{info.level2_users}}人</em>
            </div>
        </li>
        <li class="box_flex_1" data-level="3">
            <div>
                <span>第三级</span>
                <em>{{info.level3_users}}人</em>
            </div>
        </li>
    </script>
    <script>
        template.helper('toFloat', function (data, format) {
            return parseFloat(data);
        })
        function setUserInfo(userInfo) {
            $(".T_nav").html(template("moneyTemp", { info: userInfo }));

            $(".head_pic img").attr("src", userInfo.head_pic + ',1,80,80,3');
            $(".pic_r .users_month").html(userInfo.team_newuser_month);
            $(".pic_r .users_month_rank").html(userInfo.team_month_users_rank);
            $('#link1').attr('href', '/rank/myteamrank.html?userid=' + userInfo.user_id + '&type=4');
        }
        GetUserInfo(setUserInfo);

        var pageSize = 10, pageIndex = 0, level = 0, isAppend = 1;
        var param = getUrlParam("level");
        if (param) {
            level = param;
        }

        LoadChildRecommend();

        //获取下三级列表
        function LoadChildRecommend() {
            $.get("/Txooo/SalesV2/Member/Ajax/TeamAjax.ajax/GetChildRecommendV3", { pageSize: pageSize, pageIndex: pageIndex }, function (data) {
                var obj = eval(data)[0];
                if (isAppend == 0) {
                    $(".T_con_list dl").eq(1).html("");
                    $("#more").html("<div class='more'>加载中...</div>");
                }
                if (obj.count > 0) {
                    $(".pic_r .user_count").html(obj.count * 1 + 1);
                    if (obj.count <= pageSize) {
                        $("#more").hide();
                    }
                    var list = obj.list;
                    if (list.length > 0) {
                        scrollTrue = true;
                        $(".T_con_list dl").eq(1).append(template("childTemp", { info: list }))
                    } else {
                        $("#more").html("<div class='no_more'>" + obj.count + "位团员</div>");
                    }
                } else {
                    $("#more").hide();
                    $(".T_con_list dl").eq(1).html("<span class='no_list'>赶快邀请小伙伴们一起赚钱吧！<a onClick='shareIndex()'>立刻邀请</a></span>");
                }
            })
        }
        window.bindMobildIframe = function (obj) {
            window.location.reload();
        };
        $('.bind_method_login').click(function () {
            $(this).hide();
        });
        function shareIndex() {
            if ('{$UserSecurityPhone}' == '') {
                openBindByThridShareCode(function (type) {
                    $(".bind_method_login").show().find('.bind_show iframe').attr('src', '/member_2/bind/iframe.html#page-member-bind-iframe-' + type);
                });
                return;
            }
            window.location.href = '/share/index.html';
        };
        var scrollTrue = true;
        window.onscroll = function () {
            if (getScrollTop() + getClientHeight() == getScrollHeight()) {
                if (scrollTrue) {
                    scrollTrue = false;
                    pageIndex++;
                    isAppend = 1;//追加
                    LoadChildRecommend();
                }
            }
        }


        $(".T_con_nav").delegate("li", "click", function () {
            level = $(this).attr("data-level");
            $(this).siblings().removeClass("current");
            $(this).addClass("current");
            var oPrev = $(this).prev();
            oPrev.siblings().removeClass('no_border');
            oPrev.addClass('no_border');
            if (oPrev.hasClass('box_flex_1') == false) {
                $('.box_flex_1').removeClass('no_border')
            }
            isAppend = 0;//追加
            pageIndex = 0;
            LoadChildRecommend();
        })
        $.get("/Txooo/SalesV2/Member/Ajax/TeamAjax.ajax/GetUserRec", function (data) {
            if (data != "") {
                var obj = eval(decodeURIComponent(data))[0];
                $(".rec_user").html("我的邀请人 " + obj.nick_name);
                var list = [];
                list.push(obj)
                var html = template("childTemp", { info: list });
                $(".T_con_list dl").eq(0).empty().append(html);
            }
        })
        $(function () {
            $('.P_Footer .team').addClass('current')
            $(window).scroll(function () {
                var oWidth = $('.T_head_box').height()
                if ($(window).scrollTop() > oWidth) {
                    $(".T_con_nav_box").addClass('current_top');
                }
                else {
                    $(".T_con_nav_box").removeClass('current_top');
                }
            });
        })
    </script>
    <!--WL_TMP{tmp=/Skin/t/Pub/T_Public.html}-->
</body>
</html>
